{"ast":null,"code":"import api from '../api';\nexport default {\n  name: 'Lobby',\n  props: {\n    roomId: {\n      type: String,\n      required: true\n    }\n  },\n  data() {\n    return {\n      playerId: '',\n      players: [],\n      playerCount: 1,\n      pollInterval: null\n    };\n  },\n  computed: {\n    inviteLink() {\n      return `${window.location.origin}/lobby/${this.roomId}`;\n    }\n  },\n  created() {\n    // 从 URL 获取 playerId\n    this.playerId = this.$route.query.playerId;\n\n    // 开始定时获取房间状态\n    this.pollRoomStatus();\n    this.pollInterval = setInterval(this.pollRoomStatus, 3000);\n  },\n  beforeUnmount() {\n    // 清除定时器\n    if (this.pollInterval) {\n      clearInterval(this.pollInterval);\n    }\n  },\n  methods: {\n    async pollRoomStatus() {\n      try {\n        const response = await api.get(`/game/status/${this.roomId}`);\n        this.players = response.data.players;\n        this.playerCount = this.players.length;\n\n        // 如果人数已满，跳转到游戏页面\n        if (this.playerCount === 4) {\n          this.$router.push({\n            name: 'Game',\n            params: {\n              roomId: this.roomId\n            },\n            query: {\n              playerId: this.playerId\n            }\n          });\n        }\n      } catch (error) {\n        console.error('获取房间状态失败', error);\n      }\n    },\n    copyLink() {\n      navigator.clipboard.writeText(this.inviteLink).then(() => {\n        alert('邀请链接已复制到剪贴板');\n      }).catch(err => {\n        console.error('复制失败:', err);\n      });\n    },\n    goBack() {\n      this.$router.push('/');\n    }\n  }\n};","map":{"version":3,"names":["api","name","props","roomId","type","String","required","data","playerId","players","playerCount","pollInterval","computed","inviteLink","window","location","origin","created","$route","query","pollRoomStatus","setInterval","beforeUnmount","clearInterval","methods","response","get","length","$router","push","params","error","console","copyLink","navigator","clipboard","writeText","then","alert","catch","err","goBack"],"sources":["/Users/zhangyang/Desktop/py/guandan/frontend/src/views/Lobby.vue"],"sourcesContent":["<template>\n  <div class=\"lobby\">\n    <h1>等待其他玩家加入</h1>\n    \n    <div class=\"room-info\">\n      <p>房间ID: <span>{{ roomId }}</span></p>\n      <p>当前人数: <span>{{ playerCount }}/4</span></p>\n    </div>\n    \n    <div class=\"invite-link\">\n      <h2>邀请好友</h2>\n      <div class=\"link-container\">\n        <input v-model=\"inviteLink\" readonly />\n        <button @click=\"copyLink\">复制链接</button>\n      </div>\n    </div>\n    \n    <div class=\"players-list\">\n      <h2>玩家列表</h2>\n      <ul>\n        <li v-for=\"(player, index) in players\" :key=\"index\">\n          {{ player.name }}\n          <span v-if=\"player.id === playerId\">(你)</span>\n        </li>\n      </ul>\n    </div>\n    \n    <div class=\"waiting-message\" v-if=\"playerCount < 4\">\n      <p>正在等待其他玩家加入...</p>\n      <div class=\"loading-dots\">\n        <span></span>\n        <span></span>\n        <span></span>\n      </div>\n    </div>\n    \n    <button class=\"back-button\" @click=\"goBack\">返回主页</button>\n  </div>\n</template>\n\n<script>\nimport api from '../api';\n\nexport default {\n  name: 'Lobby',\n  props: {\n    roomId: {\n      type: String,\n      required: true\n    }\n  },\n  data() {\n    return {\n      playerId: '',\n      players: [],\n      playerCount: 1,\n      pollInterval: null\n    }\n  },\n  computed: {\n    inviteLink() {\n      return `${window.location.origin}/lobby/${this.roomId}`;\n    }\n  },\n  created() {\n    // 从 URL 获取 playerId\n    this.playerId = this.$route.query.playerId;\n    \n    // 开始定时获取房间状态\n    this.pollRoomStatus();\n    this.pollInterval = setInterval(this.pollRoomStatus, 3000);\n  },\n  beforeUnmount() {\n    // 清除定时器\n    if (this.pollInterval) {\n      clearInterval(this.pollInterval);\n    }\n  },\n  methods: {\n    async pollRoomStatus() {\n      try {\n        const response = await api.get(`/game/status/${this.roomId}`);\n        this.players = response.data.players;\n        this.playerCount = this.players.length;\n        \n        // 如果人数已满，跳转到游戏页面\n        if (this.playerCount === 4) {\n          this.$router.push({\n            name: 'Game',\n            params: { roomId: this.roomId },\n            query: { playerId: this.playerId }\n          });\n        }\n      } catch (error) {\n        console.error('获取房间状态失败', error);\n      }\n    },\n    copyLink() {\n      navigator.clipboard.writeText(this.inviteLink)\n        .then(() => {\n          alert('邀请链接已复制到剪贴板');\n        })\n        .catch(err => {\n          console.error('复制失败:', err);\n        });\n    },\n    goBack() {\n      this.$router.push('/');\n    }\n  }\n}\n</script>\n\n<style scoped>\n.lobby {\n  max-width: 800px;\n  margin: 0 auto;\n  padding: 40px 20px;\n  text-align: center;\n}\n\nh1 {\n  font-size: 2.5rem;\n  color: #2c3e50;\n  margin-bottom: 30px;\n}\n\nh2 {\n  font-size: 1.8rem;\n  color: #2c3e50;\n  margin-top: 30px;\n  margin-bottom: 15px;\n}\n\n.room-info {\n  background-color: #f8f9fa;\n  border-radius: 8px;\n  padding: 20px;\n  margin-bottom: 30px;\n  box-shadow: 0 4px 6px rgba(0,0,0,0.1);\n}\n\n.room-info p {\n  font-size: 1.2rem;\n  margin: 10px 0;\n}\n\n.room-info span {\n  font-weight: bold;\n  color: #42b983;\n}\n\n.invite-link {\n  margin-bottom: 30px;\n}\n\n.link-container {\n  display: flex;\n  gap: 10px;\n}\n\ninput {\n  flex: 1;\n  padding: 10px 15px;\n  border: 1px solid #ced4da;\n  border-radius: 4px;\n  font-size: 16px;\n}\n\nbutton {\n  padding: 10px 20px;\n  background-color: #42b983;\n  color: white;\n  border: none;\n  border-radius: 4px;\n  font-size: 16px;\n  cursor: pointer;\n  transition: background-color 0.3s;\n}\n\nbutton:hover {\n  background-color: #3aa876;\n}\n\n.players-list {\n  background-color: #f8f9fa;\n  border-radius: 8px;\n  padding: 20px;\n  box-shadow: 0 4px 6px rgba(0,0,0,0.1);\n}\n\nul {\n  list-style: none;\n  padding: 0;\n}\n\nli {\n  font-size: 1.2rem;\n  padding: 10px;\n  border-bottom: 1px solid #e9ecef;\n}\n\nli:last-child {\n  border-bottom: none;\n}\n\n.waiting-message {\n  margin-top: 30px;\n  font-size: 1.2rem;\n  color: #6c757d;\n}\n\n.loading-dots {\n  display: flex;\n  justify-content: center;\n  gap: 8px;\n  margin-top: 15px;\n}\n\n.loading-dots span {\n  width: 12px;\n  height: 12px;\n  background-color: #42b983;\n  border-radius: 50%;\n  display: inline-block;\n  animation: loading 1.4s infinite ease-in-out both;\n}\n\n.loading-dots span:nth-child(1) {\n  animation-delay: -0.32s;\n}\n\n.loading-dots span:nth-child(2) {\n  animation-delay: -0.16s;\n}\n\n@keyframes loading {\n  0%, 80%, 100% { transform: scale(0); }\n  40% { transform: scale(1); }\n}\n\n.back-button {\n  margin-top: 40px;\n  background-color: #6c757d;\n}\n\n.back-button:hover {\n  background-color: #5a6268;\n}\n</style> "],"mappings":"AAyCA,OAAOA,GAAE,MAAO,QAAQ;AAExB,eAAe;EACbC,IAAI,EAAE,OAAO;EACbC,KAAK,EAAE;IACLC,MAAM,EAAE;MACNC,IAAI,EAAEC,MAAM;MACZC,QAAQ,EAAE;IACZ;EACF,CAAC;EACDC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,QAAQ,EAAE,EAAE;MACZC,OAAO,EAAE,EAAE;MACXC,WAAW,EAAE,CAAC;MACdC,YAAY,EAAE;IAChB;EACF,CAAC;EACDC,QAAQ,EAAE;IACRC,UAAUA,CAAA,EAAG;MACX,OAAO,GAAGC,MAAM,CAACC,QAAQ,CAACC,MAAM,UAAU,IAAI,CAACb,MAAM,EAAE;IACzD;EACF,CAAC;EACDc,OAAOA,CAAA,EAAG;IACR;IACA,IAAI,CAACT,QAAO,GAAI,IAAI,CAACU,MAAM,CAACC,KAAK,CAACX,QAAQ;;IAE1C;IACA,IAAI,CAACY,cAAc,CAAC,CAAC;IACrB,IAAI,CAACT,YAAW,GAAIU,WAAW,CAAC,IAAI,CAACD,cAAc,EAAE,IAAI,CAAC;EAC5D,CAAC;EACDE,aAAaA,CAAA,EAAG;IACd;IACA,IAAI,IAAI,CAACX,YAAY,EAAE;MACrBY,aAAa,CAAC,IAAI,CAACZ,YAAY,CAAC;IAClC;EACF,CAAC;EACDa,OAAO,EAAE;IACP,MAAMJ,cAAcA,CAAA,EAAG;MACrB,IAAI;QACF,MAAMK,QAAO,GAAI,MAAMzB,GAAG,CAAC0B,GAAG,CAAC,gBAAgB,IAAI,CAACvB,MAAM,EAAE,CAAC;QAC7D,IAAI,CAACM,OAAM,GAAIgB,QAAQ,CAAClB,IAAI,CAACE,OAAO;QACpC,IAAI,CAACC,WAAU,GAAI,IAAI,CAACD,OAAO,CAACkB,MAAM;;QAEtC;QACA,IAAI,IAAI,CAACjB,WAAU,KAAM,CAAC,EAAE;UAC1B,IAAI,CAACkB,OAAO,CAACC,IAAI,CAAC;YAChB5B,IAAI,EAAE,MAAM;YACZ6B,MAAM,EAAE;cAAE3B,MAAM,EAAE,IAAI,CAACA;YAAO,CAAC;YAC/BgB,KAAK,EAAE;cAAEX,QAAQ,EAAE,IAAI,CAACA;YAAS;UACnC,CAAC,CAAC;QACJ;MACF,EAAE,OAAOuB,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,UAAU,EAAEA,KAAK,CAAC;MAClC;IACF,CAAC;IACDE,QAAQA,CAAA,EAAG;MACTC,SAAS,CAACC,SAAS,CAACC,SAAS,CAAC,IAAI,CAACvB,UAAU,EAC1CwB,IAAI,CAAC,MAAM;QACVC,KAAK,CAAC,aAAa,CAAC;MACtB,CAAC,EACAC,KAAK,CAACC,GAAE,IAAK;QACZR,OAAO,CAACD,KAAK,CAAC,OAAO,EAAES,GAAG,CAAC;MAC7B,CAAC,CAAC;IACN,CAAC;IACDC,MAAMA,CAAA,EAAG;MACP,IAAI,CAACb,OAAO,CAACC,IAAI,CAAC,GAAG,CAAC;IACxB;EACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}