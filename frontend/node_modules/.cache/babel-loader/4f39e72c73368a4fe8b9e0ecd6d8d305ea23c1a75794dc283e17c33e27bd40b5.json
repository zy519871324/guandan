{"ast":null,"code":"import _regeneratorRuntime from \"/Users/zhangyang/Desktop/py/guandan/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/zhangyang/Desktop/py/guandan/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/web.timers.js\";\nimport api from '../api';\nexport default {\n  name: 'Lobby',\n  props: {\n    roomId: {\n      type: String,\n      required: true\n    }\n  },\n  data: function data() {\n    return {\n      playerId: '',\n      players: [],\n      playerCount: 1,\n      pollInterval: null\n    };\n  },\n  computed: {\n    inviteLink: function inviteLink() {\n      return \"\".concat(window.location.origin, \"/lobby/\").concat(this.roomId);\n    }\n  },\n  created: function created() {\n    // 从 URL 获取 playerId\n    this.playerId = this.$route.query.playerId;\n\n    // 开始定时获取房间状态\n    this.pollRoomStatus();\n    this.pollInterval = setInterval(this.pollRoomStatus, 3000);\n  },\n  beforeUnmount: function beforeUnmount() {\n    // 清除定时器\n    if (this.pollInterval) {\n      clearInterval(this.pollInterval);\n    }\n  },\n  methods: {\n    pollRoomStatus: function pollRoomStatus() {\n      var _this = this;\n      return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var response;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return api.get(\"/game/status/\".concat(_this.roomId));\n            case 3:\n              response = _context.sent;\n              _this.players = response.data.players;\n              _this.playerCount = _this.players.length;\n\n              // 如果人数已满，跳转到游戏页面\n              if (_this.playerCount === 4) {\n                _this.$router.push({\n                  name: 'Game',\n                  params: {\n                    roomId: _this.roomId\n                  },\n                  query: {\n                    playerId: _this.playerId\n                  }\n                });\n              }\n              _context.next = 12;\n              break;\n            case 9:\n              _context.prev = 9;\n              _context.t0 = _context[\"catch\"](0);\n              console.error('获取房间状态失败', _context.t0);\n            case 12:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, null, [[0, 9]]);\n      }))();\n    },\n    copyLink: function copyLink() {\n      navigator.clipboard.writeText(this.inviteLink).then(function () {\n        alert('邀请链接已复制到剪贴板');\n      })[\"catch\"](function (err) {\n        console.error('复制失败:', err);\n      });\n    },\n    goBack: function goBack() {\n      this.$router.push('/');\n    }\n  }\n};","map":{"version":3,"names":["api","name","props","roomId","type","String","required","data","playerId","players","playerCount","pollInterval","computed","inviteLink","concat","window","location","origin","created","$route","query","pollRoomStatus","setInterval","beforeUnmount","clearInterval","methods","_this","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","wrap","_callee$","_context","prev","next","get","sent","length","$router","push","params","t0","console","error","stop","copyLink","navigator","clipboard","writeText","then","alert","err","goBack"],"sources":["/Users/zhangyang/Desktop/py/guandan/frontend/src/views/Lobby.vue"],"sourcesContent":["<template>\n  <div class=\"lobby\">\n    <h1>等待其他玩家加入</h1>\n    \n    <div class=\"room-info\">\n      <p>房间ID: <span>{{ roomId }}</span></p>\n      <p>当前人数: <span>{{ playerCount }}/4</span></p>\n    </div>\n    \n    <div class=\"invite-link\">\n      <h2>邀请好友</h2>\n      <div class=\"link-container\">\n        <input v-model=\"inviteLink\" readonly />\n        <button @click=\"copyLink\">复制链接</button>\n      </div>\n    </div>\n    \n    <div class=\"players-list\">\n      <h2>玩家列表</h2>\n      <ul>\n        <li v-for=\"(player, index) in players\" :key=\"index\">\n          {{ player.name }}\n          <span v-if=\"player.id === playerId\">(你)</span>\n        </li>\n      </ul>\n    </div>\n    \n    <div class=\"waiting-message\" v-if=\"playerCount < 4\">\n      <p>正在等待其他玩家加入...</p>\n      <div class=\"loading-dots\">\n        <span></span>\n        <span></span>\n        <span></span>\n      </div>\n    </div>\n    \n    <button class=\"back-button\" @click=\"goBack\">返回主页</button>\n  </div>\n</template>\n\n<script>\nimport api from '../api';\n\nexport default {\n  name: 'Lobby',\n  props: {\n    roomId: {\n      type: String,\n      required: true\n    }\n  },\n  data() {\n    return {\n      playerId: '',\n      players: [],\n      playerCount: 1,\n      pollInterval: null\n    }\n  },\n  computed: {\n    inviteLink() {\n      return `${window.location.origin}/lobby/${this.roomId}`;\n    }\n  },\n  created() {\n    // 从 URL 获取 playerId\n    this.playerId = this.$route.query.playerId;\n    \n    // 开始定时获取房间状态\n    this.pollRoomStatus();\n    this.pollInterval = setInterval(this.pollRoomStatus, 3000);\n  },\n  beforeUnmount() {\n    // 清除定时器\n    if (this.pollInterval) {\n      clearInterval(this.pollInterval);\n    }\n  },\n  methods: {\n    async pollRoomStatus() {\n      try {\n        const response = await api.get(`/game/status/${this.roomId}`);\n        this.players = response.data.players;\n        this.playerCount = this.players.length;\n        \n        // 如果人数已满，跳转到游戏页面\n        if (this.playerCount === 4) {\n          this.$router.push({\n            name: 'Game',\n            params: { roomId: this.roomId },\n            query: { playerId: this.playerId }\n          });\n        }\n      } catch (error) {\n        console.error('获取房间状态失败', error);\n      }\n    },\n    copyLink() {\n      navigator.clipboard.writeText(this.inviteLink)\n        .then(() => {\n          alert('邀请链接已复制到剪贴板');\n        })\n        .catch(err => {\n          console.error('复制失败:', err);\n        });\n    },\n    goBack() {\n      this.$router.push('/');\n    }\n  }\n}\n</script>\n\n<style scoped>\n.lobby {\n  max-width: 800px;\n  margin: 0 auto;\n  padding: 40px 20px;\n  text-align: center;\n}\n\nh1 {\n  font-size: 2.5rem;\n  color: #2c3e50;\n  margin-bottom: 30px;\n}\n\nh2 {\n  font-size: 1.8rem;\n  color: #2c3e50;\n  margin-top: 30px;\n  margin-bottom: 15px;\n}\n\n.room-info {\n  background-color: #f8f9fa;\n  border-radius: 8px;\n  padding: 20px;\n  margin-bottom: 30px;\n  box-shadow: 0 4px 6px rgba(0,0,0,0.1);\n}\n\n.room-info p {\n  font-size: 1.2rem;\n  margin: 10px 0;\n}\n\n.room-info span {\n  font-weight: bold;\n  color: #42b983;\n}\n\n.invite-link {\n  margin-bottom: 30px;\n}\n\n.link-container {\n  display: flex;\n  gap: 10px;\n}\n\ninput {\n  flex: 1;\n  padding: 10px 15px;\n  border: 1px solid #ced4da;\n  border-radius: 4px;\n  font-size: 16px;\n}\n\nbutton {\n  padding: 10px 20px;\n  background-color: #42b983;\n  color: white;\n  border: none;\n  border-radius: 4px;\n  font-size: 16px;\n  cursor: pointer;\n  transition: background-color 0.3s;\n}\n\nbutton:hover {\n  background-color: #3aa876;\n}\n\n.players-list {\n  background-color: #f8f9fa;\n  border-radius: 8px;\n  padding: 20px;\n  box-shadow: 0 4px 6px rgba(0,0,0,0.1);\n}\n\nul {\n  list-style: none;\n  padding: 0;\n}\n\nli {\n  font-size: 1.2rem;\n  padding: 10px;\n  border-bottom: 1px solid #e9ecef;\n}\n\nli:last-child {\n  border-bottom: none;\n}\n\n.waiting-message {\n  margin-top: 30px;\n  font-size: 1.2rem;\n  color: #6c757d;\n}\n\n.loading-dots {\n  display: flex;\n  justify-content: center;\n  gap: 8px;\n  margin-top: 15px;\n}\n\n.loading-dots span {\n  width: 12px;\n  height: 12px;\n  background-color: #42b983;\n  border-radius: 50%;\n  display: inline-block;\n  animation: loading 1.4s infinite ease-in-out both;\n}\n\n.loading-dots span:nth-child(1) {\n  animation-delay: -0.32s;\n}\n\n.loading-dots span:nth-child(2) {\n  animation-delay: -0.16s;\n}\n\n@keyframes loading {\n  0%, 80%, 100% { transform: scale(0); }\n  40% { transform: scale(1); }\n}\n\n.back-button {\n  margin-top: 40px;\n  background-color: #6c757d;\n}\n\n.back-button:hover {\n  background-color: #5a6268;\n}\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}